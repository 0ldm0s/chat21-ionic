<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>@chat21/chat21-ionic documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	      <link rel="stylesheet" href="../styles/style.css">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">@chat21/chat21-ionic documentation</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content injectable">
                   <div class="content-data">







<ol class="breadcrumb">
  <li>Injectables</li>
  <li>ChatConversationsHandler</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="active">
            <a href="#info" role="tab" id="info-tab" data-toggle="tab" data-link="info">Info</a>
        </li>
        <li >
            <a href="#source" role="tab" id="source-tab" data-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="c-info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>src/providers/chat-conversations-handler.ts</code>
        </p>




            <section>
    <h3 id="index">Index</h3>
    <table class="table table-sm table-bordered index-table">
        <tbody>
                <tr>
                    <td class="col-md-4">
                        <h6><b>Properties</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#appConfig">appConfig</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#audio">audio</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#chatManager">chatManager</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#conversations">conversations</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#databaseProvider">databaseProvider</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#events">events</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                <a href="#loggedUser">loggedUser</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                <a href="#ref">ref</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                <a href="#tenant">tenant</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#translate">translate</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#uidConvSelected">uidConvSelected</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#upSvc">upSvc</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                <a href="#userId">userId</a>
                            </li>
                            <li>
                                    <span class="modifier">Public</span>
                                <a href="#zone">zone</a>
                            </li>
                        </ul>
                    </td>
                </tr>

                <tr>
                    <td class="col-md-4">
                        <h6><b>Methods</b></h6>
                    </td>
                </tr>
                <tr>
                    <td class="col-md-4">
                        <ul class="index-list">
                            <li>
                                <a href="#addConversationListener">addConversationListener</a>
                            </li>
                            <li>
                                <a href="#added">added</a>
                            </li>
                            <li>
                                <a href="#changed">changed</a>
                            </li>
                            <li>
                                <a href="#completeConversation">completeConversation</a>
                            </li>
                            <li>
                                <a href="#connect">connect</a>
                            </li>
                            <li>
                                <a href="#countIsNew">countIsNew</a>
                            </li>
                            <li>
                                <a href="#dispose">dispose</a>
                            </li>
                            <li>
                                <a href="#getConversationByUid">getConversationByUid</a>
                            </li>
                            <li>
                                <a href="#getConversationsFromStorage">getConversationsFromStorage</a>
                            </li>
                            <li>
                                <a href="#getImageUrlThumb">getImageUrlThumb</a>
                            </li>
                            <li>
                                <a href="#getInstance">getInstance</a>
                            </li>
                            <li>
                                <a href="#getTimeLastMessage">getTimeLastMessage</a>
                            </li>
                            <li>
                                <a href="#initWithTenant">initWithTenant</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                <a href="#isValidConversation">isValidConversation</a>
                            </li>
                            <li>
                                    <span class="modifier">Private</span>
                                <a href="#isValidField">isValidField</a>
                            </li>
                            <li>
                                <a href="#removeByUid">removeByUid</a>
                            </li>
                            <li>
                                <a href="#removed">removed</a>
                            </li>
                            <li>
                                <a href="#setConversationRead">setConversationRead</a>
                            </li>
                            <li>
                                <a href="#setStatusConversation">setStatusConversation</a>
                            </li>
                            <li>
                                <a href="#soundMessage">soundMessage</a>
                            </li>
                        </ul>
                    </td>
                </tr>





        </tbody>
    </table>
</section>

            <section>
    <h3 id="constructor">Constructor</h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
<code>constructor(events: Events, chatManager: <a href="../injectables/ChatManager.html">ChatManager</a>, translate: TranslateService, tiledeskConversationsProvider: <a href="../injectables/TiledeskConversationProvider.html">TiledeskConversationProvider</a>, upSvc: <a href="../injectables/UploadService.html">UploadService</a>, zone: <a href="https://angular.io/api/core/NgZone" target="_blank">NgZone</a>, databaseProvider: <a href="../injectables/DatabaseProvider.html">DatabaseProvider</a>, appConfig: <a href="../injectables/AppConfigProvider.html">AppConfigProvider</a>)</code>
                    </td>
                </tr>
                        <tr>
                            <td class="col-md-4">
                                <div class="io-line">Defined in <a href="" data-line="36" class="link-to-prism">src/providers/chat-conversations-handler.ts:36</a></div>
                            </td>
                        </tr>

                <tr>
                    <td class="col-md-4">
                            <div>
                                    <b>Parameters :</b>
                                    <table class="params">
                                        <thead>
                                            <tr>
                                                <td>Name</td>
                                                    <td>Type</td>
                                                <td>Optional</td>
                                            </tr>
                                        </thead>
                                        <tbody>
                                                <tr>
                                                        <td>events</td>
                                                  
                                                        <td>
                                                                    <code>Events</code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>chatManager</td>
                                                  
                                                        <td>
                                                                        <code><a href="../injectables/ChatManager.html" target="_self" >ChatManager</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>translate</td>
                                                  
                                                        <td>
                                                                    <code>TranslateService</code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>tiledeskConversationsProvider</td>
                                                  
                                                        <td>
                                                                        <code><a href="../injectables/TiledeskConversationProvider.html" target="_self" >TiledeskConversationProvider</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>upSvc</td>
                                                  
                                                        <td>
                                                                        <code><a href="../injectables/UploadService.html" target="_self" >UploadService</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>zone</td>
                                                  
                                                        <td>
                                                                        <code><a href="https://angular.io/api/core/NgZone" target="_blank" >NgZone</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>databaseProvider</td>
                                                  
                                                        <td>
                                                                        <code><a href="../injectables/DatabaseProvider.html" target="_self" >DatabaseProvider</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                                <tr>
                                                        <td>appConfig</td>
                                                  
                                                        <td>
                                                                        <code><a href="../injectables/AppConfigProvider.html" target="_self" >AppConfigProvider</a></code>
                                                        </td>
                                                  
                                                    <td>
                                                            No
                                                    </td>
                                                    
                                                </tr>
                                        </tbody>
                                    </table>
                            </div>
                    </td>
                </tr>
            </tbody>
        </table>
</section>

            <section>
    
    <h3 id="methods">
        Methods
    </h3>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="addConversationListener"></a>
                    <span class="name">
                        <b>
                            addConversationListener
                        </b>
                        <a href="#addConversationListener"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>addConversationListener(uidUser, conversationId)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="378"
                            class="link-to-prism">src/providers/chat-conversations-handler.ts:378</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>uidUser</td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>conversationId</td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="added"></a>
                    <span class="name">
                        <b>
                            added
                        </b>
                        <a href="#added"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>added(childSnapshot)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="120"
                            class="link-to-prism">src/providers/chat-conversations-handler.ts:120</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>1 - aggiungo alla pos 0 la nuova conversazione all&#39;array di conversazioni 
2 - pubblico conversations:update</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>childSnapshot</td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="changed"></a>
                    <span class="name">
                        <b>
                            changed
                        </b>
                        <a href="#changed"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>changed(childSnapshot)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="151"
                            class="link-to-prism">src/providers/chat-conversations-handler.ts:151</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>1 - cerco indice conversazione nell&#39;array conversation
2 - sostituisco conversazione
3 - pubblico conversations:update</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>childSnapshot</td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="completeConversation"></a>
                    <span class="name">
                        <b>
                            completeConversation
                        </b>
                        <a href="#completeConversation"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>completeConversation(conv)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="221"
                            class="link-to-prism">src/providers/chat-conversations-handler.ts:221</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>conv</td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="../classes/ConversationModel.html" target="_self" >ConversationModel</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="connect"></a>
                    <span class="name">
                        <b>
                            connect
                        </b>
                        <a href="#connect"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>connect()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="91"
                            class="link-to-prism">src/providers/chat-conversations-handler.ts:91</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>mi connetto al nodo conversations
creo la reference
mi sottoscrivo a change, removed, added</p>
</div>

                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="countIsNew"></a>
                    <span class="name">
                        <b>
                            countIsNew
                        </b>
                        <a href="#countIsNew"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>countIsNew()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="481"
                            class="link-to-prism">src/providers/chat-conversations-handler.ts:481</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="dispose"></a>
                    <span class="name">
                        <b>
                            dispose
                        </b>
                        <a href="#dispose"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>dispose()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="338"
                            class="link-to-prism">src/providers/chat-conversations-handler.ts:338</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>1 - deseleziono tutte le conversazioni (setto tutti su on selected FALSE)
2 - evidezio la conversazione selezionata (setto selected TRUE)</p>
</div>

                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getConversationByUid"></a>
                    <span class="name">
                        <b>
                            getConversationByUid
                        </b>
                        <a href="#getConversationByUid"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>getConversationByUid(conversationUid)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="267"
                            class="link-to-prism">src/providers/chat-conversations-handler.ts:267</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>conversationUid</td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getConversationsFromStorage"></a>
                    <span class="name">
                        <b>
                            getConversationsFromStorage
                        </b>
                        <a href="#getConversationsFromStorage"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>getConversationsFromStorage()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="76"
                            class="link-to-prism">src/providers/chat-conversations-handler.ts:76</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getImageUrlThumb"></a>
                    <span class="name">
                        <b>
                            getImageUrlThumb
                        </b>
                        <a href="#getImageUrlThumb"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>getImageUrlThumb(uid: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="253"
                            class="link-to-prism">src/providers/chat-conversations-handler.ts:253</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>uid</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getInstance"></a>
                    <span class="name">
                        <b>
                            getInstance
                        </b>
                        <a href="#getInstance"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>getInstance()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="56"
                            class="link-to-prism">src/providers/chat-conversations-handler.ts:56</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>ritorno istanza di conversations handler</p>
</div>

                    <div class="io-description">
                        <b>Returns : </b>    <code>this</code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="getTimeLastMessage"></a>
                    <span class="name">
                        <b>
                            getTimeLastMessage
                        </b>
                        <a href="#getTimeLastMessage"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>getTimeLastMessage(timestamp: <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank">string</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="313"
                            class="link-to-prism">src/providers/chat-conversations-handler.ts:313</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>carico url immagine profilo passando id utente</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>timestamp</td>
                                    <td>
                                                <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="initWithTenant"></a>
                    <span class="name">
                        <b>
                            initWithTenant
                        </b>
                        <a href="#initWithTenant"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>initWithTenant(tenant, loggedUser)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="64"
                            class="link-to-prism">src/providers/chat-conversations-handler.ts:64</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>inizializzo conversations handler</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>tenant</td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>loggedUser</td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="../injectables/ChatConversationsHandler.html" target="_self" >ChatConversationsHandler</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="isValidConversation"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Private</span>
                            isValidConversation
                        </b>
                        <a href="#isValidConversation"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>isValidConversation(convToCheckId, convToCheck: <a href="../classes/ConversationModel.html">ConversationModel</a>)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="392"
                            class="link-to-prism">src/providers/chat-conversations-handler.ts:392</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Type</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>convToCheckId</td>
                                    <td>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>convToCheck</td>
                                    <td>
                                                <code><a href="../classes/ConversationModel.html" target="_self" >ConversationModel</a></code>
                                    </td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="isValidField"></a>
                    <span class="name">
                        <b>
                            <span class="modifier">Private</span>
                            isValidField
                        </b>
                        <a href="#isValidField"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
                    <span class="modifier-icon icon ion-ios-reset"></span>
                    <code>isValidField(field)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="450"
                            class="link-to-prism">src/providers/chat-conversations-handler.ts:450</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>field</td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/boolean" target="_blank" >boolean</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="removeByUid"></a>
                    <span class="name">
                        <b>
                            removeByUid
                        </b>
                        <a href="#removeByUid"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>removeByUid(uid)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="370"
                            class="link-to-prism">src/providers/chat-conversations-handler.ts:370</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>uid</td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="removed"></a>
                    <span class="name">
                        <b>
                            removed
                        </b>
                        <a href="#removed"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>removed(childSnapshot)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="175"
                            class="link-to-prism">src/providers/chat-conversations-handler.ts:175</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-description"><p>1 - cerco indice conversazione da eliminare
2 - elimino conversazione da array conversations
3 - pubblico conversations:update</p>
</div>

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>childSnapshot</td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="setConversationRead"></a>
                    <span class="name">
                        <b>
                            setConversationRead
                        </b>
                        <a href="#setConversationRead"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>setConversationRead(conversationUid)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="261"
                            class="link-to-prism">src/providers/chat-conversations-handler.ts:261</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>conversationUid</td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="setStatusConversation"></a>
                    <span class="name">
                        <b>
                            setStatusConversation
                        </b>
                        <a href="#setStatusConversation"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>setStatusConversation(sender, uid)</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="272"
                            class="link-to-prism">src/providers/chat-conversations-handler.ts:272</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Parameters :</b>
                        <table class="params">
                            <thead>
                                <tr>
                                    <td>Name</td>
                                    <td>Optional</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>sender</td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                                <tr>
                                    <td>uid</td>

                                    <td>
                                        No
                                    </td>


                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                    </div>
                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                    </div>
                    <div class="io-description">
                        
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
    <table class="table table-sm table-bordered">
        <tbody>
            <tr>
                <td class="col-md-4">
                    <a name="soundMessage"></a>
                    <span class="name">
                        <b>
                            soundMessage
                        </b>
                        <a href="#soundMessage"><span class="icon ion-ios-link"></span></a>
                    </span>
                </td>
            </tr>
            <tr>
                <td class="col-md-4">
<code>soundMessage()</code>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">
                    <div class="io-line">Defined in <a href="" data-line="492"
                            class="link-to-prism">src/providers/chat-conversations-handler.ts:492</a></div>
                </td>
            </tr>


            <tr>
                <td class="col-md-4">

                    <div class="io-description">
                        <b>Returns : </b>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >void</a></code>

                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</section>
            <section>
    
        <h3 id="inputs">
            Properties
        </h3>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="appConfig"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Public</span>
                            appConfig</b>
                            <a href="#appConfig"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="../injectables/AppConfigProvider.html" target="_self" >AppConfigProvider</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="48" class="link-to-prism">src/providers/chat-conversations-handler.ts:48</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="audio"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Public</span>
                            audio</b>
                            <a href="#audio"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="https://www.typescriptlang.org/docs/handbook/basic-types.html" target="_blank" >any</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="36" class="link-to-prism">src/providers/chat-conversations-handler.ts:36</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="chatManager"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Public</span>
                            chatManager</b>
                            <a href="#chatManager"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="../injectables/ChatManager.html" target="_self" >ChatManager</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="42" class="link-to-prism">src/providers/chat-conversations-handler.ts:42</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="conversations"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Public</span>
                            conversations</b>
                            <a href="#conversations"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="../classes/ConversationModel.html" target="_self" >ConversationModel[]</a></code>

                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>[]</code>
                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="29" class="link-to-prism">src/providers/chat-conversations-handler.ts:29</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="databaseProvider"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Public</span>
                            databaseProvider</b>
                            <a href="#databaseProvider"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="../injectables/DatabaseProvider.html" target="_self" >DatabaseProvider</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="47" class="link-to-prism">src/providers/chat-conversations-handler.ts:47</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="events"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Public</span>
                            events</b>
                            <a href="#events"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>    <code>Events</code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="41" class="link-to-prism">src/providers/chat-conversations-handler.ts:41</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="loggedUser"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Private</span>
                            loggedUser</b>
                            <a href="#loggedUser"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="../classes/UserModel.html" target="_self" >UserModel</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="33" class="link-to-prism">src/providers/chat-conversations-handler.ts:33</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="ref"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Private</span>
                            ref</b>
                            <a href="#ref"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>    <code>firebase.database.Query</code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="35" class="link-to-prism">src/providers/chat-conversations-handler.ts:35</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="tenant"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Private</span>
                            tenant</b>
                            <a href="#tenant"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="32" class="link-to-prism">src/providers/chat-conversations-handler.ts:32</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="translate"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Public</span>
                            translate</b>
                            <a href="#translate"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>    <code>TranslateService</code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="43" class="link-to-prism">src/providers/chat-conversations-handler.ts:43</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="uidConvSelected"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Public</span>
                            uidConvSelected</b>
                            <a href="#uidConvSelected"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String" target="_blank" >String</a></code>

                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Default value : </i><code>&#x27;&#x27;</code>
                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="30" class="link-to-prism">src/providers/chat-conversations-handler.ts:30</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="upSvc"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Public</span>
                            upSvc</b>
                            <a href="#upSvc"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="../injectables/UploadService.html" target="_self" >UploadService</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="45" class="link-to-prism">src/providers/chat-conversations-handler.ts:45</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="userId"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Private</span>
                            userId</b>
                            <a href="#userId"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="34" class="link-to-prism">src/providers/chat-conversations-handler.ts:34</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
        <table class="table table-sm table-bordered">
            <tbody>
                <tr>
                    <td class="col-md-4">
                        <a name="zone"></a>
                        <span class="name">
                            <b>
                                <span class="modifier">Public</span>
                            zone</b>
                            <a href="#zone"><span class="icon ion-ios-link"></span></a>
                        </span>
                    </td>
                </tr>
                    <tr>
                        <td class="col-md-4">
                            <i>Type : </i>        <code><a href="https://angular.io/api/core/NgZone" target="_blank" >NgZone</a></code>

                        </td>
                    </tr>
                        <tr>
                            <td class="col-md-4">
                                    <div class="io-line">Defined in <a href="" data-line="46" class="link-to-prism">src/providers/chat-conversations-handler.ts:46</a></div>
                            </td>
                        </tr>


            </tbody>
        </table>
</section>

    </div>


    <div class="tab-pane fade  tab-source-code" id="c-source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { Injectable, NgZone } from &#x27;@angular/core&#x27;;

import &#x27;rxjs/add/operator/map&#x27;;
import { Events } from &#x27;ionic-angular&#x27;;
// firebase
import * as firebase from &#x27;firebase/app&#x27;;
// models
import { UserModel } from &#x27;../models/user&#x27;;
import { ConversationModel } from &#x27;../models/conversation&#x27;;
// services
import { ChatManager } from &#x27;./chat-manager/chat-manager&#x27;;
// utils
// FIREBASESTORAGE_BASE_URL_IMAGE, 
import { TYPE_GROUP, URL_NO_IMAGE, TYPE_DIRECT } from &#x27;../utils/constants&#x27;;
import { compareValues, getFromNow, contactsRef, conversationsPathForUserId, searchIndexInArrayForUid } from &#x27;../utils/utils&#x27;;
import { TiledeskConversationProvider } from &#x27;./tiledesk-conversation/tiledesk-conversation&#x27;;
import { TranslateService } from &#x27;@ngx-translate/core&#x27;;

import { avatarPlaceholder, getColorBck } from &#x27;../utils/utils&#x27;;
import { UploadService } from &#x27;../providers/upload-service/upload-service&#x27;;

import { DatabaseProvider } from &#x27;../providers/database/database&#x27;;
import { AppConfigProvider } from &#x27;../providers/app-config/app-config&#x27;;
import { environment } from &#x27;../environments/environment&#x27;;

@Injectable()
export class ChatConversationsHandler {

    public conversations: ConversationModel[] &#x3D; [];
    public uidConvSelected: String &#x3D; &#x27;&#x27;;

    private tenant: string;
    private loggedUser: UserModel;
    private userId: string;
    private ref: firebase.database.Query;
    public audio: any;
    //private FIREBASESTORAGE_BASE_URL_IMAGE: string;

    //public LABEL_TU: string;
    constructor(
        public events: Events,
        public chatManager: ChatManager,
        public translate: TranslateService,
        private tiledeskConversationsProvider : TiledeskConversationProvider,
        public upSvc: UploadService,
        public zone: NgZone,
        public databaseProvider: DatabaseProvider,
        public appConfig: AppConfigProvider
    ) {
        //this.FIREBASESTORAGE_BASE_URL_IMAGE &#x3D; this.appConfig.getConfig().storageBucket;
    }

    /**
     * ritorno istanza di conversations handler
     */
    getInstance() {
        return this;
    }
    /**
     * inizializzo conversations handler
     * @param tenant 
     * @param user 
     */
    initWithTenant(tenant, loggedUser):ChatConversationsHandler{
        this.tenant &#x3D; tenant;
        this.loggedUser &#x3D; loggedUser;
        this.userId &#x3D; loggedUser.uid;
        this.conversations &#x3D; [];
        this.databaseProvider.initialize(this.loggedUser, this.tenant);
        return this;
    }

    /**
     * 
     */
    getConversationsFromStorage(){
        const that &#x3D; this;
        this.databaseProvider.getConversations()
        .then(function (conversations) {
            that.events.publish(&#x27;loadedConversationsStorage&#x27;, conversations);
        })
        .catch((error) &#x3D;&gt; {
            console.log(&quot;error::: getConversations:: &quot;, error);
        });
    }
    /**
     * mi connetto al nodo conversations
     * creo la reference
     * mi sottoscrivo a change, removed, added
     */
    connect() {
        const that &#x3D; this;
        const urlNodeFirebase &#x3D; conversationsPathForUserId(this.tenant, this.userId);
        console.log(&#x27;connect -------&gt;&#x27;, urlNodeFirebase);
        //const urlNodeFirebase &#x3D; &#x27;/apps/&#x27;+tenant+&#x27;/users/&#x27;+this.loggedUser.uid+&#x27;/conversations&#x27;;
        this.ref &#x3D; firebase.database().ref(urlNodeFirebase).orderByChild(&#x27;timestamp&#x27;).limitToLast(200);
        this.ref.on(&quot;child_changed&quot;, function(childSnapshot) {
            that.changed(childSnapshot);
        });
        this.ref.on(&quot;child_removed&quot;, function(childSnapshot) {
            that.removed(childSnapshot);
        });
        this.ref.on(&quot;child_added&quot;, function(childSnapshot) {
            that.added(childSnapshot);
        })
        // SET AUDIO
        this.audio &#x3D; new Audio();
        this.audio.src &#x3D; &#x27;assets/pling.mp3&#x27;;
        this.audio.load(); 
    }


   
    //https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/splice
    /**
     * 1 - aggiungo alla pos 0 la nuova conversazione all&#x27;array di conversazioni 
     * 2 - pubblico conversations:update
     * @param childSnapshot 
     */
    added(childSnapshot){
        const childData:ConversationModel &#x3D; childSnapshot.val();
        childData.uid &#x3D; childSnapshot.key;
        console.log(&quot;child_added conversationS&quot;, childSnapshot.val());
        const conversation &#x3D; this.completeConversation(childData);
        if (this.isValidConversation(childSnapshot.key, conversation)) {
            // add the conversation from the isConversationClosingMap
            this.tiledeskConversationsProvider.setClosingConversation(childSnapshot.key, false);
            const index &#x3D; searchIndexInArrayForUid(this.conversations, conversation.uid);
            if(index &gt; -1){
                this.conversations.splice(index, 1, conversation);
            } else {
                this.conversations.splice(0, 0, conversation);
                this.databaseProvider.setConversation(conversation);
            }
            this.conversations.sort(compareValues(&#x27;timestamp&#x27;, &#x27;desc&#x27;));
            this.events.publish(&#x27;conversationsChanged&#x27;, this.conversations);
        } else {
            console.error(&quot;ChatConversationsHandler::added::conversations with conversationId: &quot;, childSnapshot.key, &quot;is not valid&quot;);
        }
        if(conversation.is_new){
            this.soundMessage();
        }
    }

    /**
     * 1 - cerco indice conversazione nell&#x27;array conversation
     * 2 - sostituisco conversazione
     * 3 - pubblico conversations:update
     * @param childSnapshot 
     */
    changed(childSnapshot){
        const childData:ConversationModel &#x3D; childSnapshot.val();
        childData.uid &#x3D; childSnapshot.key;
        let conversation &#x3D; this.completeConversation(childData); 
        if (this.isValidConversation(childSnapshot.key, conversation)) {
            //conversation &#x3D; this.isConversationSelected(conversation, &#x27;1&#x27;);
            const index &#x3D; searchIndexInArrayForUid(this.conversations, conversation.uid);
            this.conversations.splice(index, 1, conversation);
            this.conversations.sort(compareValues(&#x27;timestamp&#x27;, &#x27;desc&#x27;));
            this.databaseProvider.setConversation(conversation);
            this.events.publish(&#x27;conversationsChanged&#x27;, this.conversations);
        } else {
            console.error(&quot;ChatConversationsHandler::changed::conversations with conversationId: &quot;, childSnapshot.key, &quot;is not valid&quot;);
        }
        if(conversation.is_new){
            this.soundMessage();
        }
    }
    /**
     * 1 - cerco indice conversazione da eliminare
     * 2 - elimino conversazione da array conversations
     * 3 - pubblico conversations:update
     * @param childSnapshot 
     */
    removed(childSnapshot){
        console.log(&quot;ChatConversationsHandler::onSnapshotRemoved::conversation:&quot;, childSnapshot.key);
        const index &#x3D; searchIndexInArrayForUid(this.conversations, childSnapshot.key);
        if(index&gt;-1){
            this.conversations.splice(index, 1);
            this.conversations.sort(compareValues(&#x27;timestamp&#x27;, &#x27;desc&#x27;));
            this.databaseProvider.removeConversation(childSnapshot.key);
            this.events.publish(&#x27;conversationsChanged&#x27;, this.conversations);
        }

        // remove the conversation from the isConversationClosingMap
        this.tiledeskConversationsProvider.deleteClosingConversation(childSnapshot.key);
       
        // // sort the array without the removed item and update the conversations list
        // this.conversations &#x3D; this.sort(this.conversations); 

        // var sortedCopy &#x3D; this.sort(this.conversations); 
        // for (var i &#x3D; 0; i &lt; sortedCopy.length; i++) {
        //     var item: ConversationModel &#x3D; sortedCopy[i];
        //     console.log(i + &quot;) ChatConversationsHandler::removed::item&quot;, item, item.timestamp);
        // }
        // this.conversations &#x3D; sortedCopy; 

        // this.events.publish(&#x27;conversations:removed&#x27;);
    }

    /**
     * 
     * @param conv 
     */
    // isConversationSelected(conv, status){
    //     conv.status &#x3D; status;
    //     if(conv.uid &#x3D;&#x3D; this.uidConvSelected){
    //         conv.selected &#x3D; true;
    //         conv.status &#x3D; &#x27;0&#x27;;
    //     }
    //     return conv;
    // }
    /**
     * Completo conversazione aggiungendo:
     * 1 - imposto selected &#x3D;&#x3D; true se è la conversazione selezionata
     * 2 - imposto fullname del sender concatenando nome e cognome e
     *   - aggiungo &#x27;tu:&#x27; se il sender coincide con il loggedUser
     * 3 - imposto il tempo trascorso dell&#x27;invio dell&#x27;ultimo messaggio
     * @param conv 
     */
    completeConversation(conv):ConversationModel{
        console.log(&#x27;completeConversation&#x27;,conv);
        var LABEL_TU &#x3D; this.translate.get(&#x27;LABEL_TU&#x27;)[&#x27;value&#x27;];
        conv.selected &#x3D; false;
        if(!conv.sender_fullname || conv.sender_fullname &#x3D;&#x3D;&#x3D; &#x27;undefined&#x27; || conv.sender_fullname.trim() &#x3D;&#x3D;&#x3D; &#x27;&#x27;){
            conv.sender_fullname &#x3D; conv.sender;
        }
        if(!conv.recipient_fullname || conv.recipient_fullname &#x3D;&#x3D;&#x3D; &#x27;undefined&#x27; || conv.recipient_fullname.trim() &#x3D;&#x3D;&#x3D; &#x27;&#x27;){
            conv.recipient_fullname &#x3D; conv.recipient;
        }
        let conversation_with_fullname &#x3D; conv.sender_fullname;
        let conversation_with &#x3D; conv.sender;
        if(conv.sender &#x3D;&#x3D;&#x3D; this.loggedUser.uid){
            conversation_with &#x3D; conv.recipient;
            conversation_with_fullname &#x3D; conv.recipient_fullname;
            conv.last_message_text &#x3D; LABEL_TU + conv.last_message_text;
        } 
        else if (conv.channel_type &#x3D;&#x3D;&#x3D; TYPE_GROUP) {
            conversation_with &#x3D; conv.recipient;
            conversation_with_fullname &#x3D; conv.recipient_fullname;
            conv.last_message_text &#x3D; conv.last_message_text;
        }
        conv.conversation_with_fullname &#x3D; conversation_with_fullname;

        conv.status &#x3D; this.setStatusConversation(conv.sender, conv.uid);
        conv.time_last_message &#x3D; this.getTimeLastMessage(conv.timestamp);;
        conv.avatar &#x3D; avatarPlaceholder(conversation_with_fullname);
        conv.color &#x3D; getColorBck(conversation_with_fullname);
        conv.image &#x3D; this.getImageUrlThumb(conversation_with);
        return conv;
    }

    getImageUrlThumb(uid: string){
        // let imageurl &#x3D; FIREBASESTORAGE_BASE_URL_IMAGE+&#x27;profiles%2F&#x27;+uid+&#x27;%2Fthumb_photo.jpg?alt&#x3D;media&#x27;;
        let imageurl &#x3D; environment.FIREBASESTORAGE_BASE_URL_IMAGE + environment.firebaseConfig.storageBucket + &#x27;/o/profiles%2F&#x27; + uid + &#x27;%2Fthumb_photo.jpg?alt&#x3D;media&#x27;;
        return imageurl;
    }
    

    // set the remote conversation as read
    setConversationRead(conversationUid) {
        var conversationRef &#x3D; this.ref.ref.child(conversationUid);
        conversationRef.update ({&quot;is_new&quot; : false});
    }

    
    getConversationByUid(conversationUid) {
        const index &#x3D; searchIndexInArrayForUid(this.conversations, conversationUid);
        return this.conversations[index];
    }

    setStatusConversation(sender, uid): string {
        let status &#x3D; &#x27;0&#x27;; //letto
        if(sender &#x3D;&#x3D;&#x3D; this.loggedUser.uid || uid &#x3D;&#x3D;&#x3D; this.uidConvSelected){
            status &#x3D; &#x27;0&#x27;; 
        } else {
            status &#x3D; &#x27;1&#x27;; // non letto
        }
        return status;
    }

    

     /**
     * carico url immagine profilo passando id utente
     */
    // setImageConversation(conv, conversation_with){
    //     const that &#x3D; this;
    //     console.log(&quot;********** displayImage uidContact::: &quot;, that.ref.ref.child(conv.uid));
    //     var conversationRef &#x3D; that.ref.ref.child(conv.uid);
    //     if(conversation_with){
    //         this.upSvc.display(conversation_with, &#x27;thumb&#x27;)
    //         .then(onResolve, onReject);
    //     }
    //     function onResolve(foundURL) { 
    //         console.log(&#x27;foundURL&#x27;, conv, foundURL);
    //         conv.image &#x3D; foundURL; 
    //         // salvo in cache e sul DB!!!
    //         conversationRef.update({&quot;image&quot; : foundURL});
    //         that.databaseProvider.setConversation(conv);
    //     } 
    //     function onReject(error){ 
    //         console.log(&#x27;error.code&#x27;, error.code); 
    //         conversationRef.child(&#x27;image&#x27;).remove();
    //         conv.image &#x3D; &#x27;&#x27;;
    //     }
    // }

    /**
     * calcolo il tempo trascorso da ora al timestamp passato
     * @param timestamp 
     */
    getTimeLastMessage(timestamp: string) {
        let timestampNumber &#x3D; parseInt(timestamp) / 1000;
        let time &#x3D; getFromNow(timestampNumber);
        return time;
    }
    /**
     * 1 - deseleziono tutte le conversazioni (setto tutti su on selected FALSE)
     * 2 - evidezio la conversazione selezionata (setto selected TRUE)
     * @param uid 
     */
    // setConversationSelected(uid): ConversationModel[]{
    //     this.conversations.forEach(function(element) {
    //         element.selected &#x3D; false;
    //     });   
    //     this.conversations.filter(function(item){
    //         if(item.uid &#x3D;&#x3D; uid){
    //         item.selected &#x3D; true;
    //         return;
    //         }
    //     });
    //     return this.conversations;
    // }
    /**
     * dispose reference di conversations
     */
    dispose() {
        this.conversations &#x3D; [];
        this.uidConvSelected &#x3D; &#x27;&#x27;;

        this.ref.off();
        this.ref.off(&quot;child_changed&quot;);
        this.ref.off(&quot;child_removed&quot;);
        this.ref.off(&quot;child_added&quot;);
    
        console.log(&quot;DISPOSE::: &quot;,this.ref);
    }

    // private clone(convs: ConversationModel[]): ConversationModel[] {
    //     var copy &#x3D; [];
    //     for (var i &#x3D; 0; i &lt; convs.length; i++) {
    //         var item: ConversationModel &#x3D; convs[i];
    //         copy.push(item);
    //     }
    //     return copy;
    // }
    // private sort(convs: ConversationModel[]): ConversationModel[] {
    //     return this.clone(convs).sort(this.compare);
    // }
    // private compare(a: ConversationModel, b: ConversationModel) : number {
    //     return (a.timestamp &lt; b.timestamp) ? 1 : ((b.timestamp &lt; a.timestamp) ? -1 : 0); 
    // }
    // private existsInArray(convs: ConversationModel[], item: ConversationModel) : boolean{
    //     return convs.some(function (el) { 
    //         return el.uid &#x3D;&#x3D;&#x3D; item.uid 
    //     }); //true
    // }

    removeByUid(uid) {
        const index &#x3D; searchIndexInArrayForUid(this.conversations, uid);
        if (index &gt; -1) {
            this.conversations.splice(index, 1);
            this.events.publish(&#x27;conversationsChanged&#x27;, this.conversations);
        }
    }

    addConversationListener(uidUser, conversationId) {
        var that &#x3D; this;
        const tenant &#x3D; this.chatManager.getTenant();
        const url &#x3D; &#x27;/apps/&#x27; + tenant + &#x27;/users/&#x27; + uidUser + &#x27;/conversations/&#x27; + conversationId;
        const reference &#x3D; firebase.database().ref(url);
        console.log(&quot;ChatConversationsHandler::addConversationListener::reference:&quot;,url, reference.toString());
        reference.on(&#x27;value&#x27;, function (snapshot) {
            setTimeout(function () {
                that.events.publish(conversationId + &#x27;-listener&#x27;, snapshot);
            }, 100);
        });
    }

    // check if the conversations is valid or not
    private isValidConversation(convToCheckId, convToCheck: ConversationModel) : boolean {
        //console.log(&quot;[BEGIN] ChatConversationsHandler:: convToCheck with uid: &quot;, convToCheckId);
        if (!this.isValidField(convToCheck.uid)) {
            //console.error(&quot;ChatConversationsHandler::isValidConversation:: &#x27;uid is not valid&#x27; &quot;);
            return false;
        }
        if (!this.isValidField(convToCheck.is_new)) {
            //console.error(&quot;ChatConversationsHandler::isValidConversation:: &#x27;is_new is not valid&#x27; &quot;);
            return false;
        }

        if (!this.isValidField(convToCheck.last_message_text)) {
            //console.error(&quot;ChatConversationsHandler::isValidConversation:: &#x27;last_message_text is not valid&#x27; &quot;);
            return false;
        }

        if (!this.isValidField(convToCheck.recipient)) {
            //console.error(&quot;ChatConversationsHandler::isValidConversation:: &#x27;recipient is not valid&#x27; &quot;);
            return false;
        }

        if (!this.isValidField(convToCheck.recipient_fullname)) {
            //console.error(&quot;ChatConversationsHandler::isValidConversation:: &#x27;recipient_fullname is not valid&#x27; &quot;);
            return false;
        }

        if (!this.isValidField(convToCheck.sender)) {
            //console.error(&quot;ChatConversationsHandler::isValidConversation:: &#x27;sender is not valid&#x27; &quot;);
            return false;
        }

        if (!this.isValidField(convToCheck.sender_fullname)) {
            //console.error(&quot;ChatConversationsHandler::isValidConversation:: &#x27;sender_fullname is not valid&#x27; &quot;);
            return false;
        }

        if (!this.isValidField(convToCheck.status)) {
            //console.error(&quot;ChatConversationsHandler::isValidConversation:: &#x27;status is not valid&#x27; &quot;);
            return false;
        }

        if (!this.isValidField(convToCheck.timestamp)) {
            //console.error(&quot;ChatConversationsHandler::isValidConversation:: &#x27;timestamp is not valid&#x27; &quot;);
            return false;
        }

        if (!this.isValidField(convToCheck.channel_type)) {
            //console.error(&quot;ChatConversationsHandler::isValidConversation:: &#x27;channel_type is not valid&#x27; &quot;);
            return false;
        }

        //console.log(&quot;[END] ChatConversationsHandler:: convToCheck with uid: &quot;, convToCheckId);

        // any other case
        return true;
    }

    // checks if a conversation&#x27;s field is valid or not
    private isValidField(field) : boolean{
        return (field &#x3D;&#x3D;&#x3D; null || field &#x3D;&#x3D;&#x3D; undefined) ? false : true;
    }

    // private getColorBck(str){
    //     var arrayBckColor &#x3D; [&#x27;#fba76f&#x27;, &#x27;#80d066&#x27;, &#x27;#73cdd0&#x27;, &#x27;#ecd074&#x27;, &#x27;#6fb1e4&#x27;, &#x27;#f98bae&#x27;];
    //     var num &#x3D; 0;
    //     if(str){
    //         var code &#x3D; str.charCodeAt((str.length-1));
    //         num &#x3D; Math.round(code%arrayBckColor.length);
    //         console.log(&#x27;************** code&#x27;,str.length, code, arrayBckColor.length, num);
    //     }
    //     return arrayBckColor[num];
    // }
    // private avatarPlaceholder(conversation_with_fullname) {
    //     var initials &#x3D; &#x27;&#x27;;
    //     if(conversation_with_fullname){
    //         var arrayName &#x3D; conversation_with_fullname.split(&quot; &quot;);
    //         arrayName.forEach(member &#x3D;&gt; {
    //             if(member.trim().length &gt; 1 &amp;&amp; initials.length &lt; 3){
    //                 initials +&#x3D; member.substring(0,1).toUpperCase();
    //             }
    //         });
    //     }
    //     return initials;
    // }


    /**
     * 
     */
    countIsNew(){
        let num &#x3D; 0;
        this.conversations.forEach(function(element) {
            if(element.is_new &#x3D;&#x3D;&#x3D; true){
            num++;
            }
        });   
        return num;
    }
  

    soundMessage(){
        console.log(&#x27;****** soundMessage *****&#x27;, this.audio);
        const that &#x3D; this;
        // this.audio &#x3D; new Audio();
        // this.audio.src &#x3D; &#x27;assets/pling.mp3&#x27;;
        // this.audio.load();
        this.audio.pause();
        this.audio.currentTime &#x3D; 0;
        setTimeout(function() {
            that.audio.play()
            .then(function() {
                // console.log(&#x27;****** then *****&#x27;);
            })
            .catch(function() {
                // console.log(&#x27;***//tiledesk-dashboard/chat*&#x27;);
            });
        }, 0);       
        
    }

      
}</code></pre>
    </div>

</div>







                   




                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> result-matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'injectable';
            var COMPODOC_CURRENT_PAGE_URL = 'ChatConversationsHandler.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>
       <!-- Required to polyfill modern browsers as code is ES5 for IE... -->
       <script src="../js/libs/custom-elements-es5-adapter.js" charset="utf-8" defer></script>
       <script src="../js/menu-wc.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
