<ion-header no-border>
    <ion-navbar color="navbarLightColor">
        <ion-buttons class="c21-buttons">
            <div class="c21-label-header c21-left">Info conversation</div>
            <button class="c21-button-header c21-right" ion-button icon-only (click)="onCloseInfoPage()">
                <ion-icon name="close"></ion-icon>
            </button>
        </ion-buttons>
        <div class="clear"></div>
    </ion-navbar>
</ion-header>

<ion-content>
    <div *ngIf="groupDetail || userDetail">
        <ion-card style="min-height:280px">
            <div class="chat21-box-profile chat21-box">
                <div class="chat21-content">
                    <div class="chat21-image">
                        <!-- <div *ngIf="channelType != TYPE_GROUP" class="chat21-avatar big" [style.background-image]="'url(' + userDetail.imageurl + ')'"></div>
                        <div *ngIf="channelType == TYPE_GROUP" class="chat21-avatar big" [style.background-image]="'url(' + groupDetail.iconURL + ')'"></div> -->
                        <img class="clip-circle" *ngIf="channelType != TYPE_GROUP" src="{{userDetail.imageurl}}" alt="user" onError="src='assets/img/no_image.png';">
                        <img class="clip-circle" *ngIf="channelType == TYPE_GROUP" src="{{groupDetail.iconURL}}" alt="user" onError="src='assets/img/no_image.png';">
                    </div>

                    <div class="chat21-info">
                        <div class="chat21-name">
                            <span *ngIf="channelType == TYPE_GROUP" class="truncate read">{{groupDetail.name}}</span>
                            <span *ngIf="channelType == TYPE_GROUP" class="truncate read">{{groupDetail.uid}}</span>
                            <span *ngIf="channelType != TYPE_GROUP" class="truncate read">{{userDetail.fullname}}</span>
                        </div>

                        <div class="chat21-status">
                            <span *ngIf="channelType != TYPE_GROUP">
                                <span *ngIf="online" class="truncate read">{{ 'LABEL_ACTIVE_NOW' | translate }}</span>
                                <span *ngIf="!online" class="truncate read">{{lastConnectionDate}}</span>
                            </span>
                            <span *ngIf="channelType == TYPE_GROUP" class="truncate read">{{ 'LABEL_CREATED_THE' |
                                translate }}{{groupDetail.createdOn}}</span>
                        </div>
                    </div>

                    <div class="chat21-conf">
                        <button *ngIf="profileYourself" class="icon_modify" icon-only (click)="presentPopover($event)">
                            <ion-icon name="create"></ion-icon>
                        </button>
                    </div>

                </div>

                <div class="chat21-uid">
                    <!-- <span *ngIf="profileYourself">{{currentUserDetail.uid}}</span> -->
                    <span>{{userDetail.uid}}</span>
                    <span *ngIf="profileYourself" class="email">email: {{userDetail.email}}</span>
                </div>
            </div>
        </ion-card>

        <ion-card>
            <div *ngIf="attributesClient" class="chat21-box-attributes chat21-box">
                <!-- *ngIf="attributesClient"  -->
                <div class="chat21-header break-line">{{ 'LABEL_INFO_ATTRIBUTE' | translate }}</div>
                <div class="chat21-content">
                    <div class="chat21-row">
                        <span class="">{{ 'LABEL_CLIENT' | translate }}</span>
                        <span class="lighter">{{attributesClient}}</span>
                    </div>
                    <div class="chat21-row">
                        <span class="">{{ 'LABEL_SOURCEPAGE' | translate }}</span>
                        <span class="lighter" [innerHTML]="attributesSourcePage"></span>
                    </div>
                    <div *ngIf="attributes && attributes.departmentId" class="chat21-row">
                        <span class="">{{ 'LABEL_DEPARTMENT_NAME' | translate }}</span>
                        <span light class="lighter">{{attributes.departmentName}}</span>
                    </div>
                    <div *ngIf="attributes && attributes.userFullname && attributes.userEmail" class="chat21-row">
                        <span class="">{{ 'LABEL_NAME' | translate }}</span>
                        <span light class="lighter">{{attributes.userFullname}}</span>
                        <br />
                        <span class="">{{ 'LABEL_EMAIL' | translate }}</span>
                        <span light class="lighter">{{attributes.userEmail}}</span>
                    </div>

                    <div *ngIf="customAttributes" class="custom-attributes-container">
                        <div class="chat21-row custom-attributes" *ngFor="let attr of customAttributes">
                            <span class="">{{ attr.key }}: </span>
                            <span class="lighter">{{ attr.value }} </span>
                        </div>
                    </div>

                </div>
                <div class="break-line"></div>
            </div>
        </ion-card>

        <div *ngIf="channelType == TYPE_GROUP && listMembers.length > 0" class="chat21-box-members chat21-box">
            <ion-card>
                <div class="chat21-header break-line">{{ 'LABEL_MEMBERS' | translate }}</div>
                <div class="chat21-content">
                    <div *ngFor="let member of listMembers" class="c21-member" (click)="openInfoUser(member)" >
                        <ion-item>
                            <ion-avatar item-start [ngStyle]="{ position: relative }">
                                <div class="chat21-avatar" [style.background-image]="'url(' + member.imageurl + ')'"></div>

                                <div *ngIf="member.checked" class="c21-icon-status c21-checked">
                                    <svg version="1.1" id="Livello_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                                    viewBox="0 0 26.6 26.6" style="enable-background:new 0 0 26.6 26.6;" xml:space="preserve">
                                    <style type="text/css">
                                        .st0{fill:none;}
                                        .st1{fill:#FFFFFF;}
                                        .st2{fill:#18BDF7;}
                                    </style>
                                    <path class="st0" d="M1.3,1.3h24v24h-24V1.3z"/>
                                    <path class="st1" d="M13.3,0L2.4,4.9v7.3c0,6.7,4.6,13,10.9,14.5c6.2-1.5,10.9-7.8,10.9-14.5V4.9L13.3,0z"/>
                                    <path class="st2" d="M13.3,2.3l-9,4v6c0,5.5,3.8,10.7,9,12c5.2-1.3,9-6.5,9-12v-6L13.3,2.3z M11.3,18.3l-4-4l1.4-1.4l2.6,2.6
                                        l6.6-6.6l1.4,1.4L11.3,18.3z"/>
                                    </svg>
                                </div>
                            
                            </ion-avatar>
                            <h2>
                                <span class="c21-point" [ngStyle]="{ 'background-color':(member.online)?'#24d066':'#db4437' }">&nbsp;</span>
                                <span *ngIf="member.fullname" class="chat21-name truncate read">{{member.fullname}}</span>
                                <span *ngIf="!member.fullname" class="chat21-name truncate read">{{ 'LABEL_GUEST' | translate }}</span>
                            </h2>
                            <p>
                                <span class="chat21-status truncate read">{{member.uid}}</span>
                            </p>
                        </ion-item>
                    </div>
                </div>
            </ion-card>


            <ion-card >
                <div *ngIf="isSupportGroup()" class="chat21-content" >
                    <button ion-button clear icon-start block 
                      (click)="sendMail()">
                      <ion-icon name='mail' is-active="false"></ion-icon>
                      <span class="c21-button-label">{{ 'LABEL_SEND_BY_EMAIL' | translate }}</span>
                    </button>
                </div>

                <div *ngIf="isSupportGroup()" class="chat21-content">
                    <button [disabled]="!conversationEnabled" ion-button clear icon-start block 
                      (click)="setVideoChat()">
                      <ion-icon name='videocam' is-active="false"></ion-icon>
                      <span class="c21-button-label">{{ 'LABEL_VIDEO_CHAT' | translate }}</span>
                    </button>
                </div>

                <div *ngIf="isSupportGroup()" class="chat21-content">
                    <button [disabled]="!conversationEnabled" ion-button clear icon-start block
                        (click)="openPopupConfirmation('close');$event.stopPropagation();">
                        <ion-icon name='close' is-active="false"></ion-icon>
                        <span class="c21-button-label">{{ 'LABEL_CLOSE_GROUP' | translate }}</span>
                    </button>
                </div>

                <div class="chat21-content">
                    <button [disabled]="!isLoggedUserGroupMember" ion-button clear icon-start block
                        (click)="openPopupConfirmation('leave')">
                        <ion-icon name='exit' is-active="false"></ion-icon>
                        <span class="c21-button-label">{{ 'LABEL_LEAVE_GROUP' | translate }}</span>
                    </button>
                </div>
            </ion-card>

        </div>

        <div class="chat21-box-images chat21-box">
        </div>
        <div class="chat21-box-documents chat21-box">
        </div>
        <div class="chat21-box-links chat21-box">
        </div>
    </div>
</ion-content>